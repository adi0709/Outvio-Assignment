{"ast":null,"code":"var _jsxFileName = \"/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/src/ViewAssembly.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useCallback, useEffect } from \"react\";\nimport { Paper, makeStyles, Typography, Button } from \"@material-ui/core\";\nimport AddPizza from \"./AddPizza\";\nimport PizzaEntry from \"./PizzaEntry\";\nimport appFetch from \"./appFetch\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  paperRoot: {\n    width: \"100%\",\n    maxWidth: \"600px\",\n    padding: theme.spacing(2),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\"\n  }\n}));\n\nconst apiGetOrderId = () => appFetch(\"/api/order\", \"GET\");\n\nconst apiSubmitOrder = data => appFetch(\"/api/order\", \"POST\", data);\n\nfunction ViewAssembly({\n  onOrdered\n}) {\n  _s();\n\n  const classes = useStyles();\n  const [pizzas, setPizzas] = useState([]);\n  const [orderId, setOrderId] = useState(null);\n  const [isLoading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    apiGetOrderId().then(result => {\n      setOrderId(result.orderId);\n      setLoading(false);\n    }).catch(err => {\n      setError(err.message || err.toString());\n      setLoading(false);\n    });\n  }, []);\n  const handleRemovePizza = useCallback(pizzaIndex => setPizzas(prev => {\n    const newArr = [...prev];\n    newArr.splice(pizzaIndex, 1);\n    return newArr;\n  }), []);\n  const handleUpdatePizza = useCallback((pizzaIndex, diff) => {\n    setPizzas(prev => {\n      return prev.map((pizza, index) => {\n        if (index === pizzaIndex) {\n          if (typeof diff.topping !== \"undefined\") {\n            if (pizza.toppings.includes(diff.topping)) {\n              return { ...pizza,\n                toppings: pizza.toppings.filter(t => t !== diff.topping)\n              };\n            } else {\n              return { ...pizza,\n                toppings: [...pizza.toppings, diff.topping]\n              };\n            }\n          } else {\n            return { ...pizza,\n              ...diff\n            };\n          }\n        }\n\n        return pizza;\n      });\n    });\n  }, []);\n  const handleSubmit = useCallback(() => {\n    setLoading(true);\n    apiSubmitOrder({\n      pizzas,\n      orderId\n    }).then(() => {\n      onOrdered();\n    }).catch(err => {\n      setError(err.message || err.toString());\n      setLoading(false);\n    });\n  }, [pizzas, orderId, onOrdered]);\n  const isSubmitDisabled = pizzas.length === 0 || pizzas.some(pizza => pizza.size === \"\" || pizza.toppings.length === 0);\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    elevation: 3,\n    classes: {\n      root: classes.paperRoot\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h5\",\n      component: \"h1\",\n      gutterBottom: true,\n      children: \"Assemble your pizza(s)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), pizzas.map((pizza, index) => /*#__PURE__*/_jsxDEV(PizzaEntry, {\n      data: pizza,\n      index: index,\n      onRemove: handleRemovePizza,\n      onUpdate: handleUpdatePizza,\n      disabled: isLoading\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(AddPizza, {\n      onAdd: () => setPizzas(prev => [...prev, {\n        size: \"\",\n        toppings: []\n      }]),\n      disabled: pizzas.length >= 3 || isLoading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), error !== null && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: \"#DC2626\",\n        marginTop: \"24px\"\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      fullWidth: true,\n      variant: \"contained\",\n      color: \"primary\",\n      \"data-e2e-button\": \"Submit\",\n      disabled: isSubmitDisabled || isLoading,\n      onClick: handleSubmit,\n      style: {\n        marginTop: \"24px\"\n      },\n      children: \"submit order\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ViewAssembly, \"Du28K3pNd6Dqgq9L/t9SYiUpQg0=\", false, function () {\n  return [useStyles];\n});\n\n_c = ViewAssembly;\nexport default ViewAssembly;\n\nvar _c;\n\n$RefreshReg$(_c, \"ViewAssembly\");","map":{"version":3,"sources":["/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/src/ViewAssembly.js"],"names":["useState","useCallback","useEffect","Paper","makeStyles","Typography","Button","AddPizza","PizzaEntry","appFetch","useStyles","theme","paperRoot","width","maxWidth","padding","spacing","display","flexDirection","alignItems","justifyContent","apiGetOrderId","apiSubmitOrder","data","ViewAssembly","onOrdered","classes","pizzas","setPizzas","orderId","setOrderId","isLoading","setLoading","error","setError","then","result","catch","err","message","toString","handleRemovePizza","pizzaIndex","prev","newArr","splice","handleUpdatePizza","diff","map","pizza","index","topping","toppings","includes","filter","t","handleSubmit","isSubmitDisabled","length","some","size","root","color","marginTop"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,WAAnB,EAAgCC,SAAhC,QAAiD,OAAjD;AAEA,SAASC,KAAT,EAAgBC,UAAhB,EAA4BC,UAA5B,EAAwCC,MAAxC,QAAsD,mBAAtD;AAEA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,QAAP,MAAqB,YAArB;;AAEA,MAAMC,SAAS,GAAGN,UAAU,CAAEO,KAAD,KAAY;AACvCC,EAAAA,SAAS,EAAE;AACTC,IAAAA,KAAK,EAAE,MADE;AAETC,IAAAA,QAAQ,EAAE,OAFD;AAGTC,IAAAA,OAAO,EAAEJ,KAAK,CAACK,OAAN,CAAc,CAAd,CAHA;AAKTC,IAAAA,OAAO,EAAE,MALA;AAMTC,IAAAA,aAAa,EAAE,QANN;AAOTC,IAAAA,UAAU,EAAE,QAPH;AAQTC,IAAAA,cAAc,EAAE;AARP;AAD4B,CAAZ,CAAD,CAA5B;;AAaA,MAAMC,aAAa,GAAG,MAAMZ,QAAQ,CAAC,YAAD,EAAe,KAAf,CAApC;;AAEA,MAAMa,cAAc,GAAIC,IAAD,IAAUd,QAAQ,CAAC,YAAD,EAAe,MAAf,EAAuBc,IAAvB,CAAzC;;AAEA,SAASC,YAAT,CAAsB;AAAEC,EAAAA;AAAF,CAAtB,EAAqC;AAAA;;AACnC,QAAMC,OAAO,GAAGhB,SAAS,EAAzB;AAEA,QAAM,CAACiB,MAAD,EAASC,SAAT,IAAsB5B,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAAC6B,OAAD,EAAUC,UAAV,IAAwB9B,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAAC+B,SAAD,EAAYC,UAAZ,IAA0BhC,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM,CAACiC,KAAD,EAAQC,QAAR,IAAoBlC,QAAQ,CAAC,IAAD,CAAlC;AAEAE,EAAAA,SAAS,CAAC,MAAM;AACdmB,IAAAA,aAAa,GACVc,IADH,CACSC,MAAD,IAAY;AAChBN,MAAAA,UAAU,CAACM,MAAM,CAACP,OAAR,CAAV;AACAG,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAJH,EAKGK,KALH,CAKUC,GAAD,IAAS;AACdJ,MAAAA,QAAQ,CAACI,GAAG,CAACC,OAAJ,IAAeD,GAAG,CAACE,QAAJ,EAAhB,CAAR;AACAR,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KARH;AASD,GAVQ,EAUN,EAVM,CAAT;AAYA,QAAMS,iBAAiB,GAAGxC,WAAW,CAClCyC,UAAD,IACEd,SAAS,CAAEe,IAAD,IAAU;AAClB,UAAMC,MAAM,GAAG,CAAC,GAAGD,IAAJ,CAAf;AACAC,IAAAA,MAAM,CAACC,MAAP,CAAcH,UAAd,EAA0B,CAA1B;AACA,WAAOE,MAAP;AACD,GAJQ,CAFwB,EAOnC,EAPmC,CAArC;AAUA,QAAME,iBAAiB,GAAG7C,WAAW,CAAC,CAACyC,UAAD,EAAaK,IAAb,KAAsB;AAC1DnB,IAAAA,SAAS,CAAEe,IAAD,IAAU;AAClB,aAAOA,IAAI,CAACK,GAAL,CAAS,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAChC,YAAIA,KAAK,KAAKR,UAAd,EAA0B;AACxB,cAAI,OAAOK,IAAI,CAACI,OAAZ,KAAwB,WAA5B,EAAyC;AACvC,gBAAIF,KAAK,CAACG,QAAN,CAAeC,QAAf,CAAwBN,IAAI,CAACI,OAA7B,CAAJ,EAA2C;AACzC,qBAAO,EACL,GAAGF,KADE;AAELG,gBAAAA,QAAQ,EAAEH,KAAK,CAACG,QAAN,CAAeE,MAAf,CAAuBC,CAAD,IAAOA,CAAC,KAAKR,IAAI,CAACI,OAAxC;AAFL,eAAP;AAID,aALD,MAKO;AACL,qBAAO,EACL,GAAGF,KADE;AAELG,gBAAAA,QAAQ,EAAE,CAAC,GAAGH,KAAK,CAACG,QAAV,EAAoBL,IAAI,CAACI,OAAzB;AAFL,eAAP;AAID;AACF,WAZD,MAYO;AACL,mBAAO,EAAE,GAAGF,KAAL;AAAY,iBAAGF;AAAf,aAAP;AACD;AACF;;AACD,eAAOE,KAAP;AACD,OAnBM,CAAP;AAoBD,KArBQ,CAAT;AAsBD,GAvBoC,EAuBlC,EAvBkC,CAArC;AAyBA,QAAMO,YAAY,GAAGvD,WAAW,CAAC,MAAM;AACrC+B,IAAAA,UAAU,CAAC,IAAD,CAAV;AAEAV,IAAAA,cAAc,CAAC;AAAEK,MAAAA,MAAF;AAAUE,MAAAA;AAAV,KAAD,CAAd,CACGM,IADH,CACQ,MAAM;AACVV,MAAAA,SAAS;AACV,KAHH,EAIGY,KAJH,CAIUC,GAAD,IAAS;AACdJ,MAAAA,QAAQ,CAACI,GAAG,CAACC,OAAJ,IAAeD,GAAG,CAACE,QAAJ,EAAhB,CAAR;AACAR,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAPH;AAQD,GAX+B,EAW7B,CAACL,MAAD,EAASE,OAAT,EAAkBJ,SAAlB,CAX6B,CAAhC;AAaA,QAAMgC,gBAAgB,GACpB9B,MAAM,CAAC+B,MAAP,KAAkB,CAAlB,IACA/B,MAAM,CAACgC,IAAP,CAAaV,KAAD,IAAWA,KAAK,CAACW,IAAN,KAAe,EAAf,IAAqBX,KAAK,CAACG,QAAN,CAAeM,MAAf,KAA0B,CAAtE,CAFF;AAIA,sBACE,QAAC,KAAD;AAAO,IAAA,SAAS,EAAE,CAAlB;AAAqB,IAAA,OAAO,EAAE;AAAEG,MAAAA,IAAI,EAAEnC,OAAO,CAACd;AAAhB,KAA9B;AAAA,4BACE,QAAC,UAAD;AAAY,MAAA,OAAO,EAAC,IAApB;AAAyB,MAAA,SAAS,EAAC,IAAnC;AAAwC,MAAA,YAAY,MAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,EAKGe,MAAM,CAACqB,GAAP,CAAW,CAACC,KAAD,EAAQC,KAAR,kBACV,QAAC,UAAD;AAEE,MAAA,IAAI,EAAED,KAFR;AAGE,MAAA,KAAK,EAAEC,KAHT;AAIE,MAAA,QAAQ,EAAET,iBAJZ;AAKE,MAAA,QAAQ,EAAEK,iBALZ;AAME,MAAA,QAAQ,EAAEf;AANZ,OACOmB,KADP;AAAA;AAAA;AAAA;AAAA,YADD,CALH,eAgBE,QAAC,QAAD;AACE,MAAA,KAAK,EAAE,MAAMtB,SAAS,CAAEe,IAAD,IAAU,CAAC,GAAGA,IAAJ,EAAU;AAAEiB,QAAAA,IAAI,EAAE,EAAR;AAAYR,QAAAA,QAAQ,EAAE;AAAtB,OAAV,CAAX,CADxB;AAEE,MAAA,QAAQ,EAAEzB,MAAM,CAAC+B,MAAP,IAAiB,CAAjB,IAAsB3B;AAFlC;AAAA;AAAA;AAAA;AAAA,YAhBF,EAqBGE,KAAK,KAAK,IAAV,iBACC;AAAG,MAAA,KAAK,EAAE;AAAE6B,QAAAA,KAAK,EAAE,SAAT;AAAoBC,QAAAA,SAAS,EAAE;AAA/B,OAAV;AAAA,gBAAoD9B;AAApD;AAAA;AAAA;AAAA;AAAA,YAtBJ,eAyBE,QAAC,MAAD;AACE,MAAA,SAAS,MADX;AAEE,MAAA,OAAO,EAAC,WAFV;AAGE,MAAA,KAAK,EAAC,SAHR;AAIE,yBAAgB,QAJlB;AAKE,MAAA,QAAQ,EAAEwB,gBAAgB,IAAI1B,SALhC;AAME,MAAA,OAAO,EAAEyB,YANX;AAOE,MAAA,KAAK,EAAE;AAAEO,QAAAA,SAAS,EAAE;AAAb,OAPT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAzBF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAuCD;;GA/GQvC,Y;UACSd,S;;;KADTc,Y;AAiHT,eAAeA,YAAf","sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\n\nimport { Paper, makeStyles, Typography, Button } from \"@material-ui/core\";\n\nimport AddPizza from \"./AddPizza\";\nimport PizzaEntry from \"./PizzaEntry\";\nimport appFetch from \"./appFetch\";\n\nconst useStyles = makeStyles((theme) => ({\n  paperRoot: {\n    width: \"100%\",\n    maxWidth: \"600px\",\n    padding: theme.spacing(2),\n\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n}));\n\nconst apiGetOrderId = () => appFetch(\"/api/order\", \"GET\");\n\nconst apiSubmitOrder = (data) => appFetch(\"/api/order\", \"POST\", data);\n\nfunction ViewAssembly({ onOrdered }) {\n  const classes = useStyles();\n\n  const [pizzas, setPizzas] = useState([]);\n  const [orderId, setOrderId] = useState(null);\n  const [isLoading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    apiGetOrderId()\n      .then((result) => {\n        setOrderId(result.orderId);\n        setLoading(false);\n      })\n      .catch((err) => {\n        setError(err.message || err.toString());\n        setLoading(false);\n      });\n  }, []);\n\n  const handleRemovePizza = useCallback(\n    (pizzaIndex) =>\n      setPizzas((prev) => {\n        const newArr = [...prev];\n        newArr.splice(pizzaIndex, 1);\n        return newArr;\n      }),\n    []\n  );\n\n  const handleUpdatePizza = useCallback((pizzaIndex, diff) => {\n    setPizzas((prev) => {\n      return prev.map((pizza, index) => {\n        if (index === pizzaIndex) {\n          if (typeof diff.topping !== \"undefined\") {\n            if (pizza.toppings.includes(diff.topping)) {\n              return {\n                ...pizza,\n                toppings: pizza.toppings.filter((t) => t !== diff.topping),\n              };\n            } else {\n              return {\n                ...pizza,\n                toppings: [...pizza.toppings, diff.topping],\n              };\n            }\n          } else {\n            return { ...pizza, ...diff };\n          }\n        }\n        return pizza;\n      });\n    });\n  }, []);\n\n  const handleSubmit = useCallback(() => {\n    setLoading(true);\n\n    apiSubmitOrder({ pizzas, orderId })\n      .then(() => {\n        onOrdered();\n      })\n      .catch((err) => {\n        setError(err.message || err.toString());\n        setLoading(false);\n      });\n  }, [pizzas, orderId, onOrdered]);\n\n  const isSubmitDisabled =\n    pizzas.length === 0 ||\n    pizzas.some((pizza) => pizza.size === \"\" || pizza.toppings.length === 0);\n\n  return (\n    <Paper elevation={3} classes={{ root: classes.paperRoot }}>\n      <Typography variant=\"h5\" component=\"h1\" gutterBottom>\n        Assemble your pizza(s)\n      </Typography>\n\n      {pizzas.map((pizza, index) => (\n        <PizzaEntry\n          key={index}\n          data={pizza}\n          index={index}\n          onRemove={handleRemovePizza}\n          onUpdate={handleUpdatePizza}\n          disabled={isLoading}\n        />\n      ))}\n\n      <AddPizza\n        onAdd={() => setPizzas((prev) => [...prev, { size: \"\", toppings: [] }])}\n        disabled={pizzas.length >= 3 || isLoading}\n      />\n\n      {error !== null && (\n        <p style={{ color: \"#DC2626\", marginTop: \"24px\" }}>{error}</p>\n      )}\n\n      <Button\n        fullWidth\n        variant=\"contained\"\n        color=\"primary\"\n        data-e2e-button=\"Submit\"\n        disabled={isSubmitDisabled || isLoading}\n        onClick={handleSubmit}\n        style={{ marginTop: \"24px\" }}\n      >\n        submit order\n      </Button>\n    </Paper>\n  );\n}\n\nexport default ViewAssembly;\n"]},"metadata":{},"sourceType":"module"}