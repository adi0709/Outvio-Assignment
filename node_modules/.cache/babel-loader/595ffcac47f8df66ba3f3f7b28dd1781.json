{"ast":null,"code":"import _objectSpread from\"/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback,useEffect}from\"react\";import{Paper,makeStyles,Typography,Button}from\"@material-ui/core\";import AddPizza from\"./AddPizza\";import PizzaEntry from\"./PizzaEntry\";import appFetch from\"./appFetch\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{paperRoot:{width:\"100%\",maxWidth:\"600px\",padding:theme.spacing(2),display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"flex-start\"}};});var apiGetOrderId=function apiGetOrderId(){return appFetch(\"/api/order\",\"GET\");};var apiSubmitOrder=function apiSubmitOrder(data){return appFetch(\"/api/order\",\"POST\",data);};function ViewAssembly(_ref){var onOrdered=_ref.onOrdered;var classes=useStyles();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),pizzas=_useState2[0],setPizzas=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),orderId=_useState4[0],setOrderId=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];useEffect(function(){apiGetOrderId().then(function(result){setOrderId(result.orderId);setLoading(false);}).catch(function(err){setError(err.message||err.toString());setLoading(false);});},[]);var handleRemovePizza=useCallback(function(pizzaIndex){return setPizzas(function(prev){var newArr=_toConsumableArray(prev);newArr.splice(pizzaIndex,1);return newArr;});},[]);var handleUpdatePizza=useCallback(function(pizzaIndex,diff){setPizzas(function(prev){return prev.map(function(pizza,index){if(index===pizzaIndex){if(typeof diff.topping!==\"undefined\"){if(pizza.toppings.includes(diff.topping)){return _objectSpread(_objectSpread({},pizza),{},{toppings:pizza.toppings.filter(function(t){return t!==diff.topping;})});}else{return _objectSpread(_objectSpread({},pizza),{},{toppings:[].concat(_toConsumableArray(pizza.toppings),[diff.topping])});}}else{return _objectSpread(_objectSpread({},pizza),diff);}}return pizza;});});},[]);var handleSubmit=useCallback(function(){setLoading(true);apiSubmitOrder({pizzas:pizzas,orderId:orderId}).then(function(){onOrdered();}).catch(function(err){setError(err.message||err.toString());setLoading(false);});},[pizzas,orderId,onOrdered]);var isSubmitDisabled=pizzas.length===0||pizzas.some(function(pizza){return pizza.size===\"\"||pizza.toppings.length===0;});return/*#__PURE__*/_jsxs(Paper,{elevation:3,classes:{root:classes.paperRoot},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h1\",gutterBottom:true,children:\"Assemble your pizza(s)\"}),pizzas.map(function(pizza,index){return/*#__PURE__*/_jsx(PizzaEntry,{data:pizza,index:index,onRemove:handleRemovePizza,onUpdate:handleUpdatePizza,disabled:isLoading},index);}),/*#__PURE__*/_jsx(AddPizza,{onAdd:function onAdd(){return setPizzas(function(prev){return[].concat(_toConsumableArray(prev),[{size:\"\",toppings:[]}]);});},disabled:pizzas.length>=3||isLoading}),error!==null&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"#DC2626\",marginTop:\"24px\"},children:error}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",color:\"primary\",disabled:isSubmitDisabled||isLoading,onClick:handleSubmit,style:{marginTop:\"24px\"},children:\"submit order\"})]});}export default ViewAssembly;","map":{"version":3,"sources":["/Users/adityapanwar/Desktop/Test/Outvio Test/qa-test/src/ViewAssembly.js"],"names":["useState","useCallback","useEffect","Paper","makeStyles","Typography","Button","AddPizza","PizzaEntry","appFetch","useStyles","theme","paperRoot","width","maxWidth","padding","spacing","display","flexDirection","alignItems","justifyContent","apiGetOrderId","apiSubmitOrder","data","ViewAssembly","onOrdered","classes","pizzas","setPizzas","orderId","setOrderId","isLoading","setLoading","error","setError","then","result","catch","err","message","toString","handleRemovePizza","pizzaIndex","prev","newArr","splice","handleUpdatePizza","diff","map","pizza","index","topping","toppings","includes","filter","t","handleSubmit","isSubmitDisabled","length","some","size","root","color","marginTop"],"mappings":"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","sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\n\nimport { Paper, makeStyles, Typography, Button } from \"@material-ui/core\";\n\nimport AddPizza from \"./AddPizza\";\nimport PizzaEntry from \"./PizzaEntry\";\nimport appFetch from \"./appFetch\";\n\nconst useStyles = makeStyles((theme) => ({\n  paperRoot: {\n    width: \"100%\",\n    maxWidth: \"600px\",\n    padding: theme.spacing(2),\n\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n}));\n\nconst apiGetOrderId = () => appFetch(\"/api/order\", \"GET\");\n\nconst apiSubmitOrder = (data) => appFetch(\"/api/order\", \"POST\", data);\n\nfunction ViewAssembly({ onOrdered }) {\n  const classes = useStyles();\n\n  const [pizzas, setPizzas] = useState([]);\n  const [orderId, setOrderId] = useState(null);\n  const [isLoading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    apiGetOrderId()\n      .then((result) => {\n        setOrderId(result.orderId);\n        setLoading(false);\n      })\n      .catch((err) => {\n        setError(err.message || err.toString());\n        setLoading(false);\n      });\n  }, []);\n\n  const handleRemovePizza = useCallback(\n    (pizzaIndex) =>\n      setPizzas((prev) => {\n        const newArr = [...prev];\n        newArr.splice(pizzaIndex, 1);\n        return newArr;\n      }),\n    []\n  );\n\n  const handleUpdatePizza = useCallback((pizzaIndex, diff) => {\n    setPizzas((prev) => {\n      return prev.map((pizza, index) => {\n        if (index === pizzaIndex) {\n          if (typeof diff.topping !== \"undefined\") {\n            if (pizza.toppings.includes(diff.topping)) {\n              return {\n                ...pizza,\n                toppings: pizza.toppings.filter((t) => t !== diff.topping),\n              };\n            } else {\n              return {\n                ...pizza,\n                toppings: [...pizza.toppings, diff.topping],\n              };\n            }\n          } else {\n            return { ...pizza, ...diff };\n          }\n        }\n        return pizza;\n      });\n    });\n  }, []);\n\n  const handleSubmit = useCallback(() => {\n    setLoading(true);\n\n    apiSubmitOrder({ pizzas, orderId })\n      .then(() => {\n        onOrdered();\n      })\n      .catch((err) => {\n        setError(err.message || err.toString());\n        setLoading(false);\n      });\n  }, [pizzas, orderId, onOrdered]);\n\n  const isSubmitDisabled =\n    pizzas.length === 0 ||\n    pizzas.some((pizza) => pizza.size === \"\" || pizza.toppings.length === 0);\n\n  return (\n    <Paper elevation={3} classes={{ root: classes.paperRoot }}>\n      <Typography variant=\"h5\" component=\"h1\" gutterBottom>\n        Assemble your pizza(s)\n      </Typography>\n\n      {pizzas.map((pizza, index) => (\n        <PizzaEntry\n          key={index}\n          data={pizza}\n          index={index}\n          onRemove={handleRemovePizza}\n          onUpdate={handleUpdatePizza}\n          disabled={isLoading}\n        />\n      ))}\n\n      <AddPizza\n        onAdd={() => setPizzas((prev) => [...prev, { size: \"\", toppings: [] }])}\n        disabled={pizzas.length >= 3 || isLoading}\n      />\n\n      {error !== null && (\n        <p style={{ color: \"#DC2626\", marginTop: \"24px\" }}>{error}</p>\n      )}\n\n      <Button\n        fullWidth\n        variant=\"contained\"\n        color=\"primary\"\n        disabled={isSubmitDisabled || isLoading}\n        onClick={handleSubmit}\n        style={{ marginTop: \"24px\" }}\n      >\n        submit order\n      </Button>\n    </Paper>\n  );\n}\n\nexport default ViewAssembly;\n"]},"metadata":{},"sourceType":"module"}